---
import Layout from '../layouts/Layout.astro';
import ProjectCard from '../components/ProjectCard.astro';
import { siteConfig } from '../config';
import { projects } from '../utils/projects';
import { getCollection } from 'astro:content';

const name = siteConfig.name;
const featuredProjects = projects.filter(project => project.featured);

// Get recent blog posts
const allPosts = await getCollection('blog');
const recentPosts = allPosts
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime())
  .slice(0, 3);

const gridClasses = featuredProjects.length === 1 ? 'grid-cols-1' :
  featuredProjects.length === 2 ? 'grid-cols-1 md:grid-cols-2' :
  'grid-cols-1 md:grid-cols-2 lg:grid-cols-3';
---

<Layout title={`${siteConfig.name} - Portfolio`}>
  <!-- Hero Section -->
  <section class="py-24 bg-gradient-to-br from-gray-50 via-white to-gray-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900">
    <div class="container text-center">
      <h1 class="text-4xl md:text-6xl font-bold text-gray-900 dark:text-white mb-6">
        Hi, I'm <span id="typewriter" class="bg-gradient-to-r from-blue-600 via-purple-500 to-pink-500 dark:from-blue-400 dark:via-purple-400 dark:to-pink-400 bg-clip-text text-transparent" data-name={name}></span>
      </h1>
      <p class="text-xl text-gray-600 dark:text-gray-300 max-w-xl mx-auto mb-10 leading-relaxed">
        CSE graduate from CUET. Full-stack developer passionate about building web apps, mobile apps, and solving algorithmic challenges.
      </p>
      <div class="flex justify-center gap-4">
        <a href="/about" class="btn btn-primary">
          Know Me More
        </a>
      </div>
    </div>
  </section>

  <!-- Featured Projects Section -->
  <section class="py-20 dark:bg-gray-900">
    <div class="container">
      <div class="text-center mb-12">
        <div class="section-badge mb-4 inline-flex">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/>
          </svg>
          Featured Work
        </div>
        <h2 class="section-title mb-3">Featured Projects</h2>
        <p class="section-description">Some things I've built recently</p>
      </div>
      <div class={`grid gap-6 justify-center ${gridClasses}`}>
        {featuredProjects.map((project) => (
          <ProjectCard {...project} />
        ))}
      </div>
      <div class="text-center mt-10">
        <a href="/projects" class="btn btn-primary font-medium no-underline">
          View all projects 
          <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Blog Section -->
  <section class="py-20 bg-gray-50 dark:bg-gray-800">
    <div class="container">
      <div class="text-center mb-12">
        <div class="section-badge mb-4 inline-flex">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>
          </svg>
          Blog
        </div>
        <h2 class="section-title mb-3">Latest Posts</h2>
        <p class="section-description">Thoughts on development and things I'm learning</p>
      </div>
      
      <div class="max-w-4xl mx-auto">
        {recentPosts.length > 0 && (
          <div class="grid gap-6">
            {recentPosts.map((post, index) => (
              <a
                href={`/blog/${post.slug}`}
                class="group block no-underline"
              >
                <article class={`relative bg-white dark:bg-gray-700 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-600 hover:border-blue-300 dark:hover:border-blue-500 transition-all duration-300 hover:shadow-lg hover:-translate-y-0.5 ${index === 0 ? 'p-6 md:p-8' : 'p-5'}`}>
                  {index === 0 && (
                    <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"></div>
                  )}
                  
                  <div class="flex flex-col md:flex-row md:items-center gap-4">
                    <div class="flex-1">
                      <div class="flex items-center gap-3 mb-2">
                        {index === 0 && (
                          <span class="px-2 py-0.5 bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 text-xs font-semibold rounded-full">
                            New
                          </span>
                        )}
                        <time class="text-sm text-gray-500 dark:text-gray-400">
                          {new Date(post.data.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
                        </time>
                      </div>
                      
                      <h3 class={`font-bold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors mb-2 ${index === 0 ? 'text-xl md:text-2xl' : 'text-lg'}`}>
                        {post.data.title}
                      </h3>
                      
                      <p class={`text-gray-600 dark:text-gray-400 ${index === 0 ? '' : 'line-clamp-1'}`}>
                        {post.data.excerpt}
                      </p>
                    </div>
                    
                    <div class="flex items-center text-blue-600 dark:text-blue-400 font-medium shrink-0">
                      <span class="hidden md:inline mr-2">Read</span>
                      <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                      </svg>
                    </div>
                  </div>
                </article>
              </a>
            ))}
          </div>
        )}
      </div>
      
      <div class="text-center mt-10">
        <a href="/blog" class="btn btn-primary px-6 py-3 ">
          View all posts
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Simple CTA Section -->
  <section class="py-24 dark:bg-gray-900">
    <div class="container">
      <div class="max-w-2xl mx-auto text-center">
        <div class="w-16 h-16 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-blue-500/10 to-purple-500/10 dark:from-blue-500/20 dark:to-purple-500/20 flex items-center justify-center">
          <svg class="w-8 h-8 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
          </svg>
        </div>
        <h2 class="section-title mb-4">Let's Communicate</h2>
        <p class="section-description mb-8 max-w-md mx-auto">
          I'm available for freelance work and interesting collaborations.
        </p>
        <a href="/contact" class="btn btn-primary">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
          </svg>
          Get in Touch
        </a>
      </div>
    </div>
  </section>
</Layout>

<!-- Client-side script (runs in browser) -->
<script>
  import { initTypewriter } from '../utils/typewriter';
  initTypewriter();
</script>

<style>
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
